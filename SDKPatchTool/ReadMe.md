# SDK Patch Tool How To

The following is generated by running `Get-Help SDKPatch.ps1 -detailed`. **DO NOT EDIT THIS MANUALLY, ENSURE THE SCRIPT IS WELL DOCUMENTED, AND JUST COPY THE OUTPUT FROM THE COMMAND**

## SDKPatch.ps1 detailed description
    
SYNOPSIS
    Downloads an SDK version and replaces the the NuGet files as part of that SDK with the here specified ones.
    
    
SYNTAX
    E:\NuGet\Entropy\SDKPatch.ps1 [-SDKPath] <String> [-NupkgsPath] <String> [-SDKChannel] <String> [[-Quality] <String>] [<CommonParameters>]
    
    
DESCRIPTION
    

PARAMETERS
    -SDKPath <String>
        The path where the patched SDK will be installed. It will be created it if doesn't exist.
        
    -NupkgsPath <String>
        The nupkgs folder which contains the latest nupkgs.
        
    -SDKChannel <String>
        Channel name of SDK. Please refer to https://learn.microsoft.com/en-us/dotnet/core/tools/dotnet-install-script#options. 
        Two-part version in A.B format, representing a specific release (for example, 6.0 or 7.0). 
        Three-part version in A.B.Cxx format, representing a specific SDK release (for example, 5.0.1xx or 5.0.2xx). Available since the 5.0 release.

    -Quality <String>
        The build quality. Works in conjunction with the channel. Likely options: `daily`, `preview` or `GA`, which represents daily, monthly and General Availability release respectively.
        Please refer to https://learn.microsoft.com/en-us/dotnet/core/tools/dotnet-install-script#options.

    <CommonParameters>
        This cmdlet supports the common parameters: Verbose, Debug,
        ErrorAction, ErrorVariable, WarningAction, WarningVariable,
        OutBuffer, PipelineVariable, and OutVariable. For more information, see
        about_CommonParameters (https:/go.microsoft.com/fwlink/?LinkID=113216).

    -------------------------- EXAMPLE 1 --------------------------

    PS C:\>.\SDKPatch.ps1 -SDKPath E:\SDK -NupkgsPath E:\NuGet\NuGet.Client\artifacts\nupkgs -SDKChannel 8.0.2xx -Quality daily

    Use this to download the latest private build of a release, if any.




    -------------------------- EXAMPLE 2 --------------------------

    PS C:\>.\SDKPatch.ps1 -SDKPath E:\SDK -NupkgsPath E:\NuGet\NuGet.Client\artifacts\nupkgs -SDKChannel 8.0.2xx -Quality preview

    Use this to download the latest public preview of a release, if any.




    -------------------------- EXAMPLE 3 --------------------------

    PS C:\>.\SDKPatch.ps1 -SDKPath E:\SDK -NupkgsPath E:\NuGet\NuGet.Client\artifacts\nupkgs -SDKChannel 8.0.2xx

    Use this to download the latest GA version of a release, if any.

## Steps

1. [Determine the best SDK version to use](#determining-the-sdk-channel-and-quality-to-use) This requires specifying the channel and the quality.
1.Go to the SDKPatchTool folder
1.Run .\SDKPatch.ps1 -SDKPath <sdk path> -NupkgsPath <nupks path> -Channel <Channel Id> -Quality <quality>
1.If you see "Finish patching", you may start testing the patched dotnet now, with absolute path
  If you see "Patching failed", you have to check why the patching is failed.

## Determining the SDK channel and quality to use

**The version of the .NET SDK that needs to be used, is the one that NuGet inserts into. That version is what ends up shipping to our customers.**
Each NuGet release has 1-to-1 mapping with .NET SDK.

NuGet follows the Visual Studio versioning, while the .NET SDK increases a major version each November, and releases a new minor release with each Visual Studio release in non-November releases.
To view historical mapping between released NuGet and SDK versions is you can refer to NuGet/SDK mapping in the NuGet the release notes. Example: <https://learn.microsoft.com/en-us/nuget/release-notes/nuget-6.8>

### Picking a channel

- Every single time a NuGet minor version changes, the SDK channel *has to be incremented*
- Each November release, the channel major version needs to be increment. For November 2023, the best SDK version is 8.0.1xx, for November 2024, the best SDK version will be 9.0.1xx.
- The NuGet & .NET SDK repos do not branch at the same time. In most releases, NuGet will switch to the next version about a week or two before the .NET SDK does.
  **If** you a given channel SDK version is not available, it is acceptable to the previous channel, for up to 2 weeks before raising issues.

Here's a versioning table with some examples:

| NuGet Version | SDK Channel | Release Month |
|---------------|-------------|------------------|
| 6.8 |  8.0.1xx | November 2023 |
| 6.9 | 8.0.2xx | February 2024 |
| 6.10 | 8.0.3xx | TBD |
| ??? | 9.0.1xx | November 2024 |

### Picking a quality

For the testing, `daily` quality should be preferred. Other available qualities are `preview` and `GA`. 

#### Putting it all together

All that said, here are some examples based on the NuGet release and time of testing.

| NuGet Version | When | Channel | Quality | Why |
|---------------|------|---------|---------|-----|
| 6.8.100 |October 2023 | 8.0.1xx | daily | We're testing the latest 8.0.100 before the release in November 2023 |
| 6.9.100 | January 2024 | 8.0.2xx | daily | We're testing the latest 8.0.2xx, before the February 2024 release |
| 6.10.5 | January 2024 | 8.0.3xx | daily | We're testing the latest 8.0.3xx, before the release sometime in 2024 |
| X.Y.Z | September 2024 | 9.0.3xx | daily | We're testing the latest 9.0.1xx, before the release in November 2024 |

#### What to do when tests fail

When tests fail with the current channel and `daily` quality, please rerun the tests with `preview` quality for the same release, or a `GA` version of the previous release as available.

If *all* tests fail, please rerun against the previous release with a quality `GA` to check for regression.
